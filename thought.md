# 记录开发遇到的问题/难点

## 用户反馈红石音乐提示制作成功但是没有音轨
### 问题
引导用户打开控制台查看报错，显示*ReferrenceError: structuredClone is not defined*  
这个函数在**/utils/MIDI.js**中被引用，用来深复制一个对象，开发时在MDN上看到该函数广泛可用，于是便没有考虑兼容性问题。提示用户切换到最新版Edge浏览器则正常运行，而使用四五年未更新的chrome浏览器则出问题。查看MDN兼容性日志，大多数浏览器在2022年初实现了该函数，所以老版本出现问题也就不足为奇。
### 解决方案
除了引导用户使用新版浏览器，更重要的是做好兼容性预案：  
* 在项目运行前检查window.structedClone是否存在，如不存在则需要手动实现该方法
* 使用成熟可靠的方案替代structedClone，比如lodash库，或者自己实现一个递归深复制

### 启示
* 虽然MDN上写了广泛兼容，但是对于时间相对较近（四五年之内）的特性，使用时应当保守
* 项目急需报错自动上传机制
	原因：
	- 不是所有用户都会主动反馈问题；
	- 报错和环境、时机、用户操作方式等随机因素相关，开发时不一定能预想到；
	- 通过报错信息，往往能第一时间找到根源。